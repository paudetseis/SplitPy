

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>splitpy.classes &mdash; SplitPy 0.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=37f418d5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            SplitPy
              <img src="../../_static/SplitPy_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../links.html">GitHub Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html#citing-splitpy">Citing SplitPy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../splitpy.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../splitpy.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../splitpy.html#using-local-data">Using local data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html#module-splitpy.gui">GUI classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html#modules">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scripts &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SplitPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">splitpy.classes</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for splitpy.classes</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 Pascal Audet &amp; Andrew Schaeffer</span>
<span class="c1">#</span>
<span class="c1"># This file is part of SplitPy.</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="c1"># SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:mod:`~splitpy` defines the following base classes:</span>

<span class="sd">- :class:`~splitpy.classes.Split`</span>
<span class="sd">- :class:`~splitpy.classes.PickPlot`</span>
<span class="sd">- :class:`~splitpy.classes.DiagPlot`</span>

<span class="sd">The class :class:`~splitpy.classes.Split` contains attributes</span>
<span class="sd">and methods for the analysis of teleseismic shear-wave splitting</span>
<span class="sd">from three-component seismograms.</span>

<span class="sd">The class :class:`~splitpy.classes.PickPlot` defines figure handles</span>
<span class="sd">for a picking window showing the seismograms and the predicted teleseismic</span>
<span class="sd">shear-wave phase arrivals. This figure is interactive and new picks can</span>
<span class="sd">be generated to refine the analysis.</span>

<span class="sd">The class :class:`~splitpy.classes.DiagPlot` defines figure handles</span>
<span class="sd">for a diagnostic figure showing a summary of the splitting results. It can</span>
<span class="sd">be called after each application of the `split.analyze` method to show</span>
<span class="sd">the summary of the analysis as a figure. This figure can also be saved as</span>
<span class="sd">a .png file.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">ceil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">splitpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span><span class="p">,</span> <span class="n">calc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">obspy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trace</span><span class="p">,</span> <span class="n">Stream</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gspec</span>


<div class="viewcode-block" id="Meta">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Meta">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Meta object contains attributes associated with the station-event</span>
<span class="sd">    data for a single Teleseismic event.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    time : :class:`~obspy.core.UTCDateTime`</span>
<span class="sd">        Origin time of earthquake</span>
<span class="sd">    dep : float</span>
<span class="sd">        Depth of hypocenter (km)</span>
<span class="sd">    lon : float</span>
<span class="sd">        Longitude coordinate of epicenter</span>
<span class="sd">    lat : float</span>
<span class="sd">        Latitude coordinate of epicenter</span>
<span class="sd">    mag : float</span>
<span class="sd">        Magnitude of earthquake</span>
<span class="sd">    gac : float</span>
<span class="sd">        Great arc circle between station and epicenter (degrees)</span>
<span class="sd">    epi_dist : float</span>
<span class="sd">        Epicentral distance between station and epicenter (km)</span>
<span class="sd">    baz : float</span>
<span class="sd">        Back-azimuth - pointing to earthquake from station (degrees)</span>
<span class="sd">    az : float</span>
<span class="sd">        Azimuth - pointing to station from earthquake (degrees)</span>
<span class="sd">    ttime : float</span>
<span class="sd">        Predicted arrival time (sec)</span>
<span class="sd">    ph : str</span>
<span class="sd">        Phase name</span>
<span class="sd">    slow : float</span>
<span class="sd">        Horizontal slowness of phase</span>
<span class="sd">    inc : float</span>
<span class="sd">        Incidence angle of phase at surface</span>
<span class="sd">    maxdt : float</span>
<span class="sd">        Maximum delay time considered in grid search (sec)</span>
<span class="sd">    ddt : float</span>
<span class="sd">        Delay time interval in grid search (sec)</span>
<span class="sd">    dphi : float</span>
<span class="sd">        Angular interval in grid search (deg)</span>
<span class="sd">    align : str</span>
<span class="sd">        Alignment of coordinate system for rotation</span>
<span class="sd">        (&#39;ZRT&#39;, &#39;LQT&#39;, or &#39;PVH&#39;)</span>
<span class="sd">    rotated : bool</span>
<span class="sd">        Whether or not data have been rotated to ``align``</span>
<span class="sd">        coordinate system</span>
<span class="sd">    zcomp : str</span>
<span class="sd">        Vertical Component Identifier. Should be a single character.</span>
<span class="sd">        This is different then &#39;Z&#39; only for fully unknown component</span>
<span class="sd">        orientation (i.e., components are 1, 2, 3)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">gacmin</span><span class="o">=</span><span class="mf">85.</span><span class="p">,</span> <span class="n">gacmax</span><span class="o">=</span><span class="mf">180.</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s1">&#39;SKS&#39;</span><span class="p">,</span>
                 <span class="n">maxdt</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">ddt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dphi</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.geodetics.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">gps2dist_azimuth</span> <span class="k">as</span> <span class="n">epi</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.geodetics</span><span class="w"> </span><span class="kn">import</span> <span class="n">kilometer2degrees</span> <span class="k">as</span> <span class="n">k2d</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.taup</span><span class="w"> </span><span class="kn">import</span> <span class="n">TauPyModel</span>

        <span class="c1"># Extract event 4D parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">longitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">latitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dep</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span>

        <span class="c1"># Check if depth is valid type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dep</span> <span class="o">&gt;</span> <span class="mf">1000.</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dep</span><span class="o">/</span><span class="mf">1000.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dep</span> <span class="o">=</span> <span class="mf">10.</span>

        <span class="c1"># Magnitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mag</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">magnitudes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mag</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.</span>

        <span class="c1"># Calculate epicentral distance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epi_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">az</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baz</span> <span class="o">=</span> <span class="n">epi</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epi_dist</span> <span class="o">/=</span> <span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gac</span> <span class="o">=</span> <span class="n">k2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epi_dist</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gac</span> <span class="o">&gt;</span> <span class="n">gacmin</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gac</span> <span class="o">&lt;</span> <span class="n">gacmax</span><span class="p">:</span>

            <span class="c1"># Get travel time info</span>
            <span class="n">tpmodel</span> <span class="o">=</span> <span class="n">TauPyModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;iasp91&#39;</span><span class="p">)</span>

            <span class="c1"># Get Travel times (Careful: here dep is in meters)</span>
            <span class="n">arrivals</span> <span class="o">=</span> <span class="n">tpmodel</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span>
                <span class="n">distance_in_degree</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gac</span><span class="p">,</span>
                <span class="n">source_depth_in_km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dep</span><span class="p">,</span>
                <span class="n">phase_list</span><span class="o">=</span><span class="p">[</span><span class="n">phase</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrivals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arrival has many entries: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrivals</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrivals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no arrival found&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span>

            <span class="n">arrival</span> <span class="o">=</span> <span class="n">arrivals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Attributes from parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ttime</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">time</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slow</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">ray_param_sec_degree</span><span class="o">/</span><span class="mf">111.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">incident_angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ttime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Attributes that get updated as analysis progresses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snrq</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snrt</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxdt</span> <span class="o">=</span> <span class="n">maxdt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddt</span> <span class="o">=</span> <span class="n">ddt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dphi</span> <span class="o">=</span> <span class="n">dphi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;LQT&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotated</span> <span class="o">=</span> <span class="kc">False</span></div>



<div class="viewcode-block" id="Result">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Result">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Result</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Result object contains attributes associated with the result</span>
<span class="sd">    of a single splitting analysis. These are equally applicable</span>
<span class="sd">    to the RC or SC method - see :func:`~splitpy.classes.analyze`.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    Emat: :class:`~numpy.ndarray`</span>
<span class="sd">        Error minimization matrix</span>
<span class="sd">    trQ_c: :class:`~obspy.core.Trace`</span>
<span class="sd">        Corrected radial (Q) component</span>
<span class="sd">    trT_c: :class:`~obspy.core.Trace`</span>
<span class="sd">        Corrected transverse (T) component</span>
<span class="sd">    trFast: :class:`~obspy.core.Trace`</span>
<span class="sd">        Corrected Fast component</span>
<span class="sd">    trSlow: :class:`~obspy.core.Trace`</span>
<span class="sd">        Corrected Slow component</span>
<span class="sd">    phi: float</span>
<span class="sd">        Azimuth of fast axis (deg)</span>
<span class="sd">    dtt: float</span>
<span class="sd">        Delay time between fast and slow axes (sec)</span>
<span class="sd">    phi_min: float</span>
<span class="sd">        Azimuth used in plotting method</span>
<span class="sd">    ephi: float</span>
<span class="sd">        Error on azimuth of fast axis (deg)</span>
<span class="sd">    edtt: float</span>
<span class="sd">        Error on delay time between fast and slow axes (sec)</span>
<span class="sd">    errc: float</span>
<span class="sd">        Error contours on `Emat`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Emat</span><span class="p">,</span> <span class="n">trQ_c</span><span class="p">,</span> <span class="n">trT_c</span><span class="p">,</span> <span class="n">trFast</span><span class="p">,</span>
                 <span class="n">trSlow</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dtt</span><span class="p">,</span> <span class="n">phi_min</span><span class="p">,</span> <span class="n">edtt</span><span class="p">,</span> <span class="n">ephi</span><span class="p">,</span> <span class="n">errc</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Emat</span> <span class="o">=</span> <span class="n">Emat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trQ_c</span> <span class="o">=</span> <span class="n">trQ_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trT_c</span> <span class="o">=</span> <span class="n">trT_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trFast</span> <span class="o">=</span> <span class="n">trFast</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trSlow</span> <span class="o">=</span> <span class="n">trSlow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtt</span> <span class="o">=</span> <span class="n">dtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi_min</span> <span class="o">=</span> <span class="n">phi_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edtt</span> <span class="o">=</span> <span class="n">edtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ephi</span> <span class="o">=</span> <span class="n">ephi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errc</span> <span class="o">=</span> <span class="n">errc</span></div>



<div class="viewcode-block" id="Split">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Split</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Split object contains dictionary attributes that associate</span>
<span class="sd">    station information with single event (i.e., earthquake)</span>
<span class="sd">    metadata, corresponding raw and rotated seismograms and</span>
<span class="sd">    splitting results.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The object is initialized with the ``sta`` field only, and</span>
<span class="sd">    other attributes are added to the object as the analysis proceeds.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    sta : :class:`~stdb.StDbElement`</span>
<span class="sd">        Object containing station information </span>
<span class="sd">        from a :mod:`~stdb` database.</span>
<span class="sd">    meta : :class:`~splitpy.classes.Meta`</span>
<span class="sd">        Object of metadata information for single event.</span>
<span class="sd">    dataZNE : :class:`~obspy.core.Stream`</span>
<span class="sd">        Object containing raw ZNE trace data</span>
<span class="sd">    dataLQT : :class:`~obspy.core.Stream`</span>
<span class="sd">        Object containing rotated trace data</span>
<span class="sd">    dataZ12 : :class:`~obspy.core.Stream`</span>
<span class="sd">        Object containing (resampled) Z12 trace data</span>
<span class="sd">        (for un-oriented data; optional)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">zcomp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>

        <span class="c1"># Attributes from parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sta</span> <span class="o">=</span> <span class="n">sta</span>

        <span class="c1"># Initialize meta and data objects as None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zcomp</span> <span class="o">=</span> <span class="n">zcomp</span>

<div class="viewcode-block" id="Split.add_event">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.add_event">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">gacmin</span><span class="o">=</span><span class="mf">85.</span><span class="p">,</span> <span class="n">gacmax</span><span class="o">=</span><span class="mf">120.</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s1">&#39;SKS&#39;</span><span class="p">,</span>
                  <span class="n">returned</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds event metadata to Split object as Meta object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : :class:`~obspy.core.event`</span>
<span class="sd">            Event metadata</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.geodetics.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">gps2dist_azimuth</span> <span class="k">as</span> <span class="n">epi</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.geodetics</span><span class="w"> </span><span class="kn">import</span> <span class="n">kilometer2degrees</span> <span class="k">as</span> <span class="n">k2d</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.taup</span><span class="w"> </span><span class="kn">import</span> <span class="n">TauPyModel</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.core.event.event</span><span class="w"> </span><span class="kn">import</span> <span class="n">Event</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">Event</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Event has incorrect type&quot;</span><span class="p">))</span>

        <span class="c1"># Store as object attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">Meta</span><span class="p">(</span><span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sta</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span>
                         <span class="n">gacmin</span><span class="o">=</span><span class="n">gacmin</span><span class="p">,</span> <span class="n">gacmax</span><span class="o">=</span><span class="n">gacmax</span><span class="p">,</span>
                         <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">returned</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span></div>


<div class="viewcode-block" id="Split.download_data">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.download_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">download_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">new_sr</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">dts</span><span class="o">=</span><span class="mf">120.</span><span class="p">,</span>
                      <span class="n">returned</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">remove_response</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads seismograms based on event origin time and</span>
<span class="sd">        P phase arrival and adds as object attributes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        client : :class:`~obspy.client.fdsn.Client`</span>
<span class="sd">            Client object</span>
<span class="sd">        new_sr : float</span>
<span class="sd">            New sampling rate (Hz)</span>
<span class="sd">        dts : float</span>
<span class="sd">            Time duration (sec)</span>
<span class="sd">        remove_response : bool</span>
<span class="sd">            Remove instrument response from seismogram and resitute to true ground</span>
<span class="sd">            velocity (m/s) using obspy.core.trace.Trace.remove_response()</span>
<span class="sd">        returned : bool</span>
<span class="sd">            Whether or not to return the ``accept`` attribute</span>
<span class="sd">        verbose : bool</span>
<span class="sd">            Output diagnostics to screen</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        accept : bool</span>
<span class="sd">            Whether or not the object is accepted for further analysis</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Requires event data as attribute - aborting&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Define start time for request</span>
        <span class="n">tstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">-</span> <span class="n">dts</span>
        <span class="n">tend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="n">dts</span>

        <span class="c1"># Get waveforms</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;* Requesting Waveforms: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*    Startime: &quot;</span> <span class="o">+</span> <span class="n">tstart</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*    Endtime:  &quot;</span> <span class="o">+</span> <span class="n">tend</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">))</span>

        <span class="c1"># Download data</span>
        <span class="n">err</span><span class="p">,</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sta</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">tstart</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">tend</span><span class="p">,</span>
            <span class="n">new_sr</span><span class="o">=</span><span class="n">new_sr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">remove_response</span><span class="o">=</span><span class="n">remove_response</span><span class="p">,</span>
            <span class="n">zcomp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zcomp</span><span class="p">)</span>

        <span class="c1"># Store as attributes with traces in dictionary</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">trE</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">trN</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">trZ</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="p">[</span><span class="n">trZ</span><span class="p">,</span> <span class="n">trN</span><span class="p">,</span> <span class="n">trE</span><span class="p">])</span>

            <span class="c1"># Filter Traces and resample</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">new_sr</span><span class="p">,</span>
                                <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">new_sr</span><span class="p">,</span> <span class="n">no_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># If there is no ZNE, perhaps there is Z12 (or zcomp12)?</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">tr1</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tr2</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">trZ</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zcomp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># Force channel name to &#39;Z&#39; if zcomp is not &#39;Z&#39;&#39;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcomp</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
                    <span class="n">trZ</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">trZ</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;Z&#39;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="p">[</span><span class="n">trZ</span><span class="p">,</span> <span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">])</span>

                <span class="c1"># Filter Traces and resample</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">new_sr</span><span class="p">,</span>
                                    <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">new_sr</span><span class="p">,</span> <span class="n">no_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="c1"># Save Z12 components in case it&#39;s necessary for later</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataZ12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="c1"># Rotate from Z12 to ZNE using StDb azcorr attribute</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;ZNE&#39;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">returned</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span></div>


<div class="viewcode-block" id="Split.rotate">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.rotate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotates 3-component seismograms from vertical (Z),</span>
<span class="sd">        east (E) and north (N) to longitudinal (L),</span>
<span class="sd">        radial (Q) and tangential (T) components of motion.</span>
<span class="sd">        Note that the method &#39;rotate&#39; from ``obspy.core.stream.Stream``</span>
<span class="sd">        is used for the rotation ``&#39;ZNE-&gt;LQT&#39;``.</span>

<span class="sd">        Can also rotate Z12 to ZNE.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : str</span>
<span class="sd">            Alignment of coordinate system for rotation</span>
<span class="sd">            (&#39;ZNE&#39; or &#39;LQT&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">rotated</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data have been rotated already - continuing&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Use default values from meta data if arguments are not specified</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">align</span><span class="p">:</span>
            <span class="n">align</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">align</span>

        <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;ZNE&#39;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.signal.rotate</span><span class="w"> </span><span class="kn">import</span> <span class="n">rotate2zne</span>

            <span class="c1"># Copy traces</span>
            <span class="n">trZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">trN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">trE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">azim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sta</span><span class="o">.</span><span class="n">azcorr</span>

            <span class="c1"># Try with left handed system</span>
            <span class="n">Z</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">rotate2zne</span><span class="p">(</span><span class="n">trZ</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="n">trN</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                 <span class="n">azim</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">trE</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">azim</span><span class="o">+</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

            <span class="c1"># Z, N, E = rotate2zne(trZ.data, 0., -90., trN.data,</span>
            <span class="c1">#                      azim, 0., trE.data, azim+90., 0.)</span>
            <span class="n">trN</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">N</span>
            <span class="n">trE</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">E</span>

            <span class="c1"># Update stats of streams</span>
            <span class="n">trN</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">trN</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;N&#39;</span>
            <span class="n">trE</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">trE</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;E&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="p">[</span><span class="n">trZ</span><span class="p">,</span> <span class="n">trN</span><span class="p">,</span> <span class="n">trE</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;LQT&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="s1">&#39;ZNE-&gt;LQT&#39;</span><span class="p">,</span>
                        <span class="n">back_azimuth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">,</span>
                        <span class="n">inclination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span>
            <span class="c1"># for tr in data:</span>
            <span class="c1">#     if tr.stats.channel.endswith(&#39;Q&#39;):</span>
            <span class="c1">#         tr.data = -tr.data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">rotated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;incorrect &#39;align&#39; argument&quot;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Split.calc_snr">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.calc_snr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_snr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates signal-to-noise ratio on either Z, L or P component</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t1 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            Pick time of arrival (sec)</span>
<span class="sd">        dt : float</span>
<span class="sd">            Duration (sec)</span>
<span class="sd">        fmin : float</span>
<span class="sd">            Minimum frequency corner for SNR filter (Hz)</span>
<span class="sd">        fmax : float</span>
<span class="sd">            Maximum frequency corner for SNR filter (Hz)</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        snrq : float</span>
<span class="sd">            Signal-to-noise ratio on vertical component (dB)</span>
<span class="sd">        snrh : float</span>
<span class="sd">            Signal-to-noise ratio on radial component (dB)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">accept</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span>

        <span class="c1"># Copy trace to signal and noise traces</span>
        <span class="n">trSigQ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trNzeQ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trSigT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trNzeT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">trSigQ</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">trNzeQ</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">trSigT</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">trNzeT</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

        <span class="c1"># Filter between 0.1 and 1.0 (dominant P wave frequencies)</span>
        <span class="n">trSigQ</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
                      <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">trSigT</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
                      <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">trNzeQ</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
                      <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">trNzeT</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
                      <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Trim around S-wave arrival</span>
        <span class="n">trSigQ</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">trNzeQ</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">dt</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
        <span class="n">trSigT</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">trNzeT</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">dt</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>

        <span class="c1"># Calculate root mean square (RMS) and SNR</span>
        <span class="n">srms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">trSigQ</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
        <span class="n">nrms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">trNzeQ</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrq</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">srms</span><span class="o">*</span><span class="n">srms</span><span class="o">/</span><span class="n">nrms</span><span class="o">/</span><span class="n">nrms</span><span class="p">)</span>

        <span class="n">srms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">trSigT</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
        <span class="n">nrms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">trNzeT</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">srms</span><span class="o">*</span><span class="n">srms</span><span class="o">/</span><span class="n">nrms</span><span class="o">/</span><span class="n">nrms</span><span class="p">)</span></div>


<div class="viewcode-block" id="Split.analyze">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.analyze">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxdt</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">ddt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dphi</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the shear-wave splitting parameters based</span>
<span class="sd">        on two alternative method: the Rotation-Correlation (RC)</span>
<span class="sd">        method and the Silver-Chan (SC) method. Each set of results</span>
<span class="sd">        is stored in a Dictionary as attributes of the split object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t1 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            Start time of picking window</span>
<span class="sd">        t2 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            End time of picking window</span>
<span class="sd">        verbose : bool</span>
<span class="sd">            Output diagnostics to screen</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        RC_res : :class:`~splitpy.classes.Result`</span>
<span class="sd">            Object containing results of Rotation-Correlation method</span>
<span class="sd">        SC_res : :class:`~splitpy.classes.Result`</span>
<span class="sd">            Object containing results of Silver-Chan method</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">maxdt</span> <span class="o">=</span> <span class="n">maxdt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ddt</span> <span class="o">=</span> <span class="n">ddt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dphi</span> <span class="o">=</span> <span class="n">dphi</span>

        <span class="k">if</span> <span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">-</span> <span class="mf">5.</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">25.</span>

        <span class="c1"># Define signal</span>
        <span class="n">trQ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Calculate Silver and Chan splitting estimate</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;* --&gt; Calculating Rotation-Correlation (RC) Splitting&quot;</span><span class="p">)</span>
        <span class="n">Emat</span><span class="p">,</span> <span class="n">trQ_c</span><span class="p">,</span> <span class="n">trT_c</span><span class="p">,</span> <span class="n">trFast</span><span class="p">,</span> <span class="n">trSlow</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dtt</span><span class="p">,</span> <span class="n">phi_min</span> <span class="o">=</span> \
            <span class="n">calc</span><span class="o">.</span><span class="n">split_RotCorr</span><span class="p">(</span>
                <span class="n">trQ</span><span class="p">,</span> <span class="n">trT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span>
                <span class="n">maxdt</span><span class="p">,</span> <span class="n">ddt</span><span class="p">,</span> <span class="n">dphi</span><span class="p">)</span>

        <span class="c1"># Calculate error</span>
        <span class="n">edtt</span><span class="p">,</span> <span class="n">ephi</span><span class="p">,</span> <span class="n">errc</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">split_errorRC</span><span class="p">(</span>
            <span class="n">trT_c</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">Emat</span><span class="p">,</span>
            <span class="n">maxdt</span><span class="p">,</span> <span class="n">ddt</span><span class="p">,</span> <span class="n">dphi</span><span class="p">)</span>

        <span class="c1"># Store dictionary as attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span><span class="n">Emat</span><span class="p">,</span> <span class="n">trQ_c</span><span class="p">,</span> <span class="n">trT_c</span><span class="p">,</span> <span class="n">trFast</span><span class="p">,</span> <span class="n">trSlow</span><span class="p">,</span>
                             <span class="n">phi</span><span class="p">,</span> <span class="n">dtt</span><span class="p">,</span> <span class="n">phi_min</span><span class="p">,</span> <span class="n">edtt</span><span class="p">,</span> <span class="n">ephi</span><span class="p">,</span> <span class="n">errc</span><span class="p">)</span>

        <span class="c1"># Calculate Silver and Chan splitting estimate</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;* --&gt; Calculating Silver-Chan (SC) Splitting&quot;</span><span class="p">)</span>
        <span class="n">Emat</span><span class="p">,</span> <span class="n">trQ_c</span><span class="p">,</span> <span class="n">trT_c</span><span class="p">,</span> <span class="n">trFast</span><span class="p">,</span> <span class="n">trSlow</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dtt</span><span class="p">,</span> <span class="n">phi_min</span> <span class="o">=</span> \
            <span class="n">calc</span><span class="o">.</span><span class="n">split_SilverChan</span><span class="p">(</span>
                <span class="n">trQ</span><span class="p">,</span> <span class="n">trT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span>
                <span class="n">maxdt</span><span class="p">,</span> <span class="n">ddt</span><span class="p">,</span> <span class="n">dphi</span><span class="p">)</span>

        <span class="c1"># Calculate errors</span>
        <span class="n">edtt</span><span class="p">,</span> <span class="n">ephi</span><span class="p">,</span> <span class="n">errc</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">split_errorSC</span><span class="p">(</span>
            <span class="n">trT_c</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">Emat</span><span class="p">,</span>
            <span class="n">maxdt</span><span class="p">,</span> <span class="n">ddt</span><span class="p">,</span> <span class="n">dphi</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span><span class="n">Emat</span><span class="p">,</span> <span class="n">trQ_c</span><span class="p">,</span> <span class="n">trT_c</span><span class="p">,</span> <span class="n">trFast</span><span class="p">,</span> <span class="n">trSlow</span><span class="p">,</span>
                             <span class="n">phi</span><span class="p">,</span> <span class="n">dtt</span><span class="p">,</span> <span class="n">phi_min</span><span class="p">,</span> <span class="n">edtt</span><span class="p">,</span> <span class="n">ephi</span><span class="p">,</span> <span class="n">errc</span><span class="p">)</span></div>


<div class="viewcode-block" id="Split.is_null">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.is_null">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_null</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snrTlim</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if splitting result is a Null result</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        snrTlim : float</span>
<span class="sd">            Threshold for snr on T component</span>
<span class="sd">        verbose : bool</span>
<span class="sd">            Output diagnostics to screen</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        null : bool</span>
<span class="sd">            Boolean for Null result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">null</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Calculate Angular Difference for Null Measurement</span>
        <span class="n">dphi</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">),</span>
                   <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dphi</span> <span class="o">&gt;</span> <span class="mf">90.</span><span class="p">:</span>
            <span class="n">dphi</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">dphi</span>

        <span class="c1"># Summarize Null Measurement</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="s2">&quot;Null Classification: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span> <span class="o">&lt;</span> <span class="n">snrTlim</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="s2">&quot;  SNR T Fail: </span><span class="si">{0:.2f}</span><span class="s2"> &lt; </span><span class="si">{1:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span><span class="p">,</span> <span class="n">snrTlim</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="s2">&quot;  SNR T Pass: </span><span class="si">{0:.2f}</span><span class="s2"> &gt; </span><span class="si">{1:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span><span class="p">,</span> <span class="n">snrTlim</span><span class="p">))</span>
            <span class="k">if</span> <span class="mf">22.</span> <span class="o">&lt;</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mf">68.</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;  dPhi Fail: </span><span class="si">{0:.2f}</span><span class="s2"> within 22. &lt; X &lt; 68.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dphi</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                    <span class="s2">&quot;  dPhi Pass:  </span><span class="si">{0:.2f}</span><span class="s2"> outside 22. &lt; X &lt; 68.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dphi</span><span class="p">))</span>

        <span class="c1"># Check snr on tangential component</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span> <span class="o">&lt;</span> <span class="n">snrTlim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">null</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Check error on `phi_min` estimate</span>
        <span class="k">if</span> <span class="mf">22.</span> <span class="o">&lt;</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mf">68.</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">null</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Split.get_quality">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.get_quality">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the quality of the estimate (either Null or non-Null)</span>
<span class="sd">        based on ratio of delay times and difference in fast axis directions</span>
<span class="sd">        between Rotation-Correlation and Silver-Chan methods</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool</span>
<span class="sd">            Output diagnostics to screen</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        quality : str</span>
<span class="sd">            String representing quality of estimate (&#39;Good&#39;, &#39;Fair&#39;, &#39;Poor&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Ratio of delay times</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">dtt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">dtt</span>

        <span class="c1"># Test based on difference in fast axis directions</span>
        <span class="n">dphi</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">),</span>
                   <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dphi</span> <span class="o">&gt;</span> <span class="mf">90.</span><span class="p">:</span>
            <span class="n">dphi</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">dphi</span>

        <span class="c1"># If estimate is Null</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rho</span> <span class="o">&lt;</span> <span class="mf">0.2</span> <span class="ow">and</span> <span class="p">(</span><span class="mf">37.</span> <span class="o">&lt;</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mi">53</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Good&#39;</span>
            <span class="k">elif</span> <span class="n">rho</span> <span class="o">&lt;</span> <span class="mf">0.3</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">32</span> <span class="o">&lt;</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mi">58</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Fair&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Poor&#39;</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;Quality Estimate: Null -- </span><span class="si">{0:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;    rho: </span><span class="si">{0:.2f}</span><span class="s2">; dphi: </span><span class="si">{1:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">dphi</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Good: rho &lt; 0.2  &amp;&amp;  37 &lt; dphi &lt; 53&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Fair: rho &lt; 0.3  &amp;&amp;  32 &lt; dphi &lt; 58&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Poor: rho &gt; 0.3  &amp;&amp;  dphi &lt; 32 | dphi &gt; 58&quot;</span><span class="p">)</span>

        <span class="c1"># If estimate is non-Null</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">&lt;</span> <span class="n">rho</span> <span class="o">&lt;</span> <span class="mf">1.1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mf">8.</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Good&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="mf">0.7</span> <span class="o">&lt;</span> <span class="n">rho</span> <span class="o">&lt;</span> <span class="mf">1.2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dphi</span> <span class="o">&lt;</span> <span class="mf">15.</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Fair&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="s1">&#39;Poor&#39;</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                    <span class="s2">&quot;Quality Estimate: Non-Null -- </span><span class="si">{0:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;    rho: </span><span class="si">{0:.2f}</span><span class="s2">; dphi: </span><span class="si">{1:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">dphi</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Good: 0.8 &lt; rho &lt; 1.1  &amp;&amp;  dphi &lt; 8&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Fair: 0.7 &lt; rho &lt; 1.2  &amp;&amp;  dphi &lt; 15&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span>
                      <span class="s2">&quot;      Poor: rho &lt; 0.7 | rho &gt; 1.3 &amp;&amp;  dphi &gt; 15&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Split.display_results">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.display_results">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">display_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints out best fitting results to screen</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds : int</span>
<span class="sd">            Number of spaces to print out to screen (verbiage)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; ======= Best-fit splitting results ========&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Best fit values: RC method&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Phi = &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:3d}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">+</span>
              <span class="s1">&#39; degrees +/- &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:2d}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">ephi</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; dt = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39; seconds +/- &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">edtt</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Best fit values: SC method&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Phi = &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:3d}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">+</span>
              <span class="s1">&#39; degrees +/- &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:2d}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">ephi</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; dt = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39; seconds +/- &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">edtt</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="Split.display_meta">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.display_meta">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">display_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">ds</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints out content of metadata to screen</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds : int</span>
<span class="sd">            Number of spaces to print out to screen (verbiage)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; ======= Meta data ========&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; SNR (dB):            &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.0f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrq</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Station:             &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sta</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Time:                &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Event depth (km):    &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.0f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dep</span><span class="o">/</span><span class="mf">1000.</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Magnitude (Mw):      &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">mag</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Longitude (deg):     &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">lon</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Latitude (deg):      &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; GAC (deg):           &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">gac</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Backazimuth deg):    &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Incidence (deg):      &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">inc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; SNR - Q:      &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrq</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; SNR - T:      &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">snrt</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="Split.display_null_quality">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.display_null_quality">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">display_null_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints out null and quality estimates to screen</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds : int</span>
<span class="sd">            Number of spaces to print out to screen (verbiage)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; ======= Nulls and quality ========&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Is Null?     &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">null</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">ds</span> <span class="o">+</span> <span class="s1">&#39; Quality:     &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="Split.save">
<a class="viewcode-back" href="../../api.html#splitpy.classes.Split.save">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves Split object to file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str</span>
<span class="sd">            File name for split object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PickPlot">
<a class="viewcode-back" href="../../api.html#splitpy.classes.PickPlot">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PickPlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A PickPlot object contains figure handles and method to plot</span>
<span class="sd">    seismic data for picking/refining the SKS time window.</span>
<span class="sd">    The figure displays the LQT seismograms and predicted arrival</span>
<span class="sd">    times for common shear-wave arrivals in the time window.</span>
<span class="sd">    The figure can be picked to refine the time window for</span>
<span class="sd">    calculating the  splitting results.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The object is initialized with a :class:`~splitpy.classes.Split` object,</span>
<span class="sd">    which is temporarily stored as an attribute. All the split attributes</span>
<span class="sd">    are therefore available to the :class:`~splitpy.clases.PickPlot` object</span>
<span class="sd">    for plotting.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    split : :class:`~splitpy.classes.Split` object</span>
<span class="sd">        Split object containing attributes after analysis has been carried out.</span>
<span class="sd">    fp : List</span>
<span class="sd">        List of figure handles ([fig, ax1, ax2, ax3])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">):</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">obspy.taup</span><span class="w"> </span><span class="kn">import</span> <span class="n">TauPyModel</span>

        <span class="c1"># Store split as attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">split</span>

        <span class="c1"># Get travel time info</span>
        <span class="n">tpmodel</span> <span class="o">=</span> <span class="n">TauPyModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;iasp91&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;SKS&#39;</span><span class="p">,</span> <span class="s1">&#39;SKKS&#39;</span><span class="p">,</span> <span class="s1">&#39;PKS&#39;</span><span class="p">,</span> <span class="s1">&#39;ScS&#39;</span><span class="p">]</span>

        <span class="c1"># Get Travel times (Careful: here dep is in meters)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrivals</span> <span class="o">=</span> <span class="n">tpmodel</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span>
            <span class="n">distance_in_degree</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">gac</span><span class="p">,</span>
            <span class="n">source_depth_in_km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dep</span><span class="p">,</span>
            <span class="n">phase_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_list</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">init_pickw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ylab</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Sets default axis attributes and return axis handle</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>
<span class="sd">            title : str</span>
<span class="sd">                Title of axis</span>
<span class="sd">            ylab : str</span>
<span class="sd">                Y-axis label</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            ax : :class:`matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="s1">&#39;RC_res&#39;</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span>
                <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;analysis has not yet been performed &quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;on split object. Aborting&quot;</span><span class="p">))</span>

        <span class="c1"># Make sure to clear figure if it already exists at initialization</span>
        <span class="k">if</span> <span class="n">plt</span><span class="o">.</span><span class="n">fignum_exists</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="c1"># Define plot as GridSpec object</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Figure handle</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="c1"># L component seismogram</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>  <span class="c1"># 0:3</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">sta</span><span class="o">.</span><span class="n">network</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">sta</span><span class="o">.</span><span class="n">station</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">init_pickw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">)</span>

        <span class="c1"># Q component seismogram</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span>  <span class="c1"># 3:7</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">init_pickw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>

        <span class="c1"># T component seismogram</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">23</span><span class="p">])</span>  <span class="c1"># 8:11</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">init_pickw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]</span>

        <span class="c1"># Ensure Figure is open</span>
        <span class="c1"># fp[0].canvas.draw()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Store handles as attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>

<div class="viewcode-block" id="PickPlot.plot_LQT_phases">
<a class="viewcode-back" href="../../api.html#splitpy.classes.PickPlot.plot_LQT_phases">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_LQT_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dts</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots rotated three-components of motion for picking.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tt : :class:`~obspy.taup.TauPyModel`</span>
<span class="sd">            Taup object containing travel time and phase info</span>
<span class="sd">        dts : float</span>
<span class="sd">            Time interval (?)</span>
<span class="sd">        t1 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            Start time of picking window</span>
<span class="sd">        t2 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            End time of picking window</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        ll : List</span>
<span class="sd">            List of :class:`~matplotlib.pyplot.axvline` objects for plotting the start and</span>
<span class="sd">            end times of the picking window.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">rotated</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Split object not rotated - aborting&quot;</span><span class="p">))</span>

        <span class="c1"># Default start and end times</span>
        <span class="k">if</span> <span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">-</span> <span class="mf">5.</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">25.</span>

        <span class="c1"># Define signal and noise</span>
        <span class="n">trL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trQ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Define time axis</span>
        <span class="n">taxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">trL</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span><span class="o">/</span><span class="n">trL</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">-</span> <span class="n">dts</span>
        <span class="n">tstart</span> <span class="o">=</span> <span class="n">trL</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>

        <span class="c1"># Set uniform vertical scale</span>
        <span class="n">maxL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trL</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">maxQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trQ</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">maxT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trT</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">maxL</span><span class="p">,</span> <span class="n">maxQ</span><span class="p">,</span> <span class="n">maxT</span><span class="p">])</span>

        <span class="c1"># Plot traces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">trL</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">trQ</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">trT</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">)</span>

        <span class="c1"># Set tight limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="c1"># Add vertical lines for picked times</span>
        <span class="n">ll</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ll</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">-</span> <span class="n">dts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Store List of lines as attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span> <span class="o">=</span> <span class="n">ll</span>

        <span class="c1"># Add vertical lines and text for various phases</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrivals</span><span class="p">:</span>

            <span class="n">name</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">time</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
                              <span class="n">name</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
                              <span class="n">name</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
                              <span class="n">name</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

        <span class="c1"># Update plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="PickPlot.update_LQT">
<a class="viewcode-back" href="../../api.html#splitpy.classes.PickPlot.update_LQT">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_LQT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates LQT figure with newly picked times</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tp1 : float</span>
<span class="sd">            New start time of picking window</span>
<span class="sd">        tp2 : float</span>
<span class="sd">            New end time of picking window</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Remove lines from previously picked times</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="c1"># Add new vertical lines with new picks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tp2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Update figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="PickPlot.save">
<a class="viewcode-back" href="../../api.html#splitpy.classes.PickPlot.save">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves current figure into file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str</span>
<span class="sd">            File name for diagnostic figure</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DiagPlot">
<a class="viewcode-back" href="../../api.html#splitpy.classes.DiagPlot">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DiagPlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A DiagPlot object contains figure handles and methods to plot</span>
<span class="sd">    the diagnostic figure, which displays the LQT seismograms,</span>
<span class="sd">    the corrected/un-corrected seismograms, the particle motions,</span>
<span class="sd">    the minimization matrix and a text box with a summary of the</span>
<span class="sd">    analysis - for each of the two analysis methods (&#39;RC&#39; or &#39;SC&#39;)</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The object is initialized with a :class:`~splitpy.classes.Split` object,</span>
<span class="sd">    which is temporarily stored as an attribute. All the split attributes</span>
<span class="sd">    are therefore available to the :class:`~splitpy.clases.DiagPlot` object</span>
<span class="sd">    for plotting.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    split : :class:`~splitpy.classes.Split` object</span>
<span class="sd">        Split object containing attributes after analysis has been carried out.</span>
<span class="sd">    fd : List</span>
<span class="sd">        List of figure handles ([fig, ax0, axt, axRC1, axRC2, axRC3, axRC4,\</span>
<span class="sd">                axSC1, axSC2, axSC3, axSC4])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">split</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initializes window for splitting results</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>
<span class="sd">            title : str</span>
<span class="sd">                Title of axis</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">init_pmotion</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initializes window for particle motion</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;W $\longleftrightarrow$ E&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;S $\longleftrightarrow$ N&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Particle Motion&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">init_emap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initializes window for matrix minimization</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>
<span class="sd">            title : str</span>
<span class="sd">                Title of axis</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            ax : :class:`~matplotlib.pyplot.axis`</span>
<span class="sd">                Axis handle</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$ (deg)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta t$ (sec)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">ax</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="s1">&#39;RC_res&#39;</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span>
                <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;analysis has not yet been performed on &quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;split object. Aborting&quot;</span><span class="p">))</span>

        <span class="c1"># Make sure to clear figure if it already exists at initialization</span>
        <span class="k">if</span> <span class="n">plt</span><span class="o">.</span><span class="n">fignum_exists</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="c1"># Figure handle</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="c1"># Q, T component seismograms</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="n">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Q, T&#39;</span><span class="p">)</span>

        <span class="c1"># Text box</span>
        <span class="n">axt</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
        <span class="n">axt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Fast, Slow window for Rotation-Correlation</span>
        <span class="n">axRC1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axRC1</span> <span class="o">=</span> <span class="n">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axRC1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Corrected Fast, Slow&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Q, T window</span>
        <span class="n">axRC2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axRC2</span> <span class="o">=</span> <span class="n">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axRC2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Corrected Q, T&#39;</span><span class="p">)</span>

        <span class="c1"># Particle motion</span>
        <span class="n">axRC3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5375</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.175</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axRC3</span> <span class="o">=</span> <span class="n">init_pmotion</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axRC3</span><span class="p">)</span>

        <span class="c1"># Energy map</span>
        <span class="n">axRC4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.775</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axRC4</span> <span class="o">=</span> <span class="n">init_emap</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axRC4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Map of correlation coeff&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Fast, Slow window for Silver-Chan</span>
        <span class="n">axSC1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axSC1</span> <span class="o">=</span> <span class="n">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axSC1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Corrected Fast, Slow&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Q, T window</span>
        <span class="n">axSC2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axSC2</span> <span class="o">=</span> <span class="n">init_splitw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axSC2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Corrected Q, T&#39;</span><span class="p">)</span>

        <span class="c1"># Particle motion</span>
        <span class="n">axSC3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5375</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.175</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axSC3</span> <span class="o">=</span> <span class="n">init_pmotion</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axSC3</span><span class="p">)</span>

        <span class="c1"># Energy map</span>
        <span class="n">axSC4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.775</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axSC4</span> <span class="o">=</span> <span class="n">init_emap</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axSC4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Energy map of T&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span><span class="p">,</span> <span class="n">axt</span><span class="p">,</span> <span class="n">axRC1</span><span class="p">,</span> <span class="n">axRC2</span><span class="p">,</span> <span class="n">axRC3</span><span class="p">,</span> <span class="n">axRC4</span><span class="p">,</span>
                <span class="n">axSC1</span><span class="p">,</span> <span class="n">axSC2</span><span class="p">,</span> <span class="n">axSC3</span><span class="p">,</span> <span class="n">axSC4</span><span class="p">]</span>

        <span class="c1"># # Make sure figure is open</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Store handes as attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>

<div class="viewcode-block" id="DiagPlot.plot_diagnostic">
<a class="viewcode-back" href="../../api.html#splitpy.classes.DiagPlot.plot_diagnostic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_diagnostic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots diagnostic window with estimates from both &#39;RC&#39; and &#39;SC&#39; methods</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t1 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            Start time of picking window</span>
<span class="sd">        t2 : :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">            End time of picking window</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>

        <span class="k">if</span> <span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">-</span> <span class="mf">5.</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ttime</span> <span class="o">+</span> <span class="mf">25.</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">rot3D</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">baz</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Defines rotation matrix from incidence and back-azimuth angles</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            inc : float</span>
<span class="sd">                Incidence angle in degrees</span>
<span class="sd">            baz : float</span>
<span class="sd">                Back-azimuth angle in degrees</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            M : :class:`~numpy.ndarray`</span>
<span class="sd">                Rotation matrix</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Angles in radians</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">/</span><span class="mf">180.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">baz</span> <span class="o">=</span> <span class="n">baz</span><span class="o">/</span><span class="mf">180.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="c1"># Define rotation matrix</span>
            <span class="n">M</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">inc</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">baz</span><span class="p">),</span>
                  <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">baz</span><span class="p">)],</span>
                 <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">inc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">baz</span><span class="p">),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">baz</span><span class="p">)],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">baz</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">baz</span><span class="p">)]]</span>

            <span class="k">return</span> <span class="n">M</span>

        <span class="c1"># Copy traces to avoid overridding</span>
        <span class="n">trL_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trL_tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="n">trQ_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trQ_tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="n">trT_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataLQT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trT_tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="n">trE_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trE_tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="n">trN_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">dataZNE</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trN_tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

        <span class="c1"># Rotate seismograms for plots</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">rot3D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">inc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">)</span>
        <span class="n">ZEN_RC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
            <span class="p">[</span><span class="n">trL_tmp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trQ_c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trT_c</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
        <span class="n">E_RC</span> <span class="o">=</span> <span class="n">ZEN_RC</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">N_RC</span> <span class="o">=</span> <span class="n">ZEN_RC</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">ZEN_SC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
            <span class="p">[</span><span class="n">trL_tmp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trQ_c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trT_c</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
        <span class="n">E_SC</span> <span class="o">=</span> <span class="n">ZEN_SC</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">N_SC</span> <span class="o">=</span> <span class="n">ZEN_SC</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1"># Original time series</span>
        <span class="n">taxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">trQ_tmp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span><span class="o">/</span><span class="n">trQ_tmp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trQ_tmp</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trT_tmp</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">max1</span><span class="p">,</span> <span class="n">max2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">trQ_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">trT_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Text box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;Event: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;     &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;N  &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;E   &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dep</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;km   &#39;</span> <span class="o">+</span> <span class="s1">&#39;Mw=&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">mag</span><span class="p">),</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;Station: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">sta</span><span class="o">.</span><span class="n">station</span> <span class="o">+</span>
            <span class="s1">&#39;   Backazimuth: &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   Distance: &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">gac</span><span class="p">),</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Best fit RC values: $\phi$=&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\pm$&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">ephi</span><span class="p">)</span> <span class="o">+</span>
            <span class="sa">r</span><span class="s1">&#39;   $\delta t$=&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\pm$&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">edtt</span><span class="p">)</span> <span class="o">+</span>
            <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Best fit SC values: $\phi$=&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\pm$&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">ephi</span><span class="p">)</span> <span class="o">+</span>
            <span class="sa">r</span><span class="s1">&#39;   $\delta t$=&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\pm$&#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">edtt</span><span class="p">)</span> <span class="o">+</span>
            <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;Is Null? &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">null</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;    Quality? &#39;</span> <span class="o">+</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">quality</span><span class="p">),</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

        <span class="c1"># Rotation-correlation</span>
        <span class="c1"># Corrected Fast and Slow</span>
        <span class="n">sum1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">sum2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sum1</span> <span class="o">&lt;</span> <span class="n">sum2</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
        <span class="n">taxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span> <span class="o">/</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">max1</span><span class="p">,</span> <span class="n">max2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">sig</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fast&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Slow&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Q and T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trQ_c</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">trT_c</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Particle motion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trE_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="n">trN_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_RC</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="n">N_RC</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Raw&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;RC&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ang</span> <span class="o">=</span> <span class="mf">360.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">baz</span>
        <span class="n">x1pos</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
        <span class="n">y1pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
        <span class="n">x2pos</span> <span class="o">=</span> <span class="o">-</span><span class="n">x1pos</span>
        <span class="n">y2pos</span> <span class="o">=</span> <span class="o">-</span><span class="n">y1pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1pos</span><span class="p">,</span> <span class="n">x2pos</span><span class="p">],</span> <span class="p">[</span><span class="n">y1pos</span><span class="p">,</span> <span class="n">y2pos</span><span class="p">],</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Map of energy</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">maxdt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ddt</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dphi</span><span class="p">)</span>

        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dt</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">dt</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">Emat</span><span class="p">,</span>
            <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi_min</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dphi</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">Emin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">Emat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">Emax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">Emat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">dE</span> <span class="o">=</span> <span class="p">(</span><span class="n">Emax</span> <span class="o">-</span> <span class="n">Emin</span><span class="p">)</span><span class="o">/</span><span class="mf">16.</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span><span class="p">,</span> <span class="n">dE</span><span class="p">)</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu_r</span>
        <span class="n">cset1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)))</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;contour.negative_linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;solid&#39;</span>
        <span class="n">errc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">errc</span>
        <span class="n">ecset</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="p">(</span><span class="n">errc</span><span class="p">,</span> <span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span>
                            <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">RC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>

        <span class="c1"># Silver-Chan</span>
        <span class="c1"># Corrected Fast and Slow</span>
        <span class="n">sum1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">sum2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sum1</span> <span class="o">&lt;</span> <span class="n">sum2</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
        <span class="n">taxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span> <span class="o">/</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">max1</span><span class="p">,</span> <span class="n">max2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trFast</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="n">sig</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trSlow</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Corrected Q and T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trQ_c</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">taxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">trT_c</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Particle motion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trE_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="n">trN_tmp</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_SC</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="n">N_SC</span><span class="o">/</span><span class="n">mmax</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1pos</span><span class="p">,</span> <span class="n">x2pos</span><span class="p">],</span> <span class="p">[</span><span class="n">y1pos</span><span class="p">,</span> <span class="n">y2pos</span><span class="p">],</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Raw&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># Map of energy</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">maxdt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ddt</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dphi</span><span class="p">)</span>

        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dt</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">dt</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

        <span class="n">E2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">Emat</span><span class="p">,</span>
            <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi_min</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dphi</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">Emin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">Emat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">Emax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">Emat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">dE</span> <span class="o">=</span> <span class="p">(</span><span class="n">Emax</span> <span class="o">-</span> <span class="n">Emin</span><span class="p">)</span><span class="o">/</span><span class="mf">16.</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span><span class="p">,</span> <span class="n">dE</span><span class="p">)</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu_r</span>
        <span class="n">cset1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)))</span>

        <span class="n">errc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">errc</span>
        <span class="n">ecset</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="p">(</span><span class="n">errc</span><span class="p">,),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span>
                            <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">dtt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">SC_res</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

        <span class="c1"># plt.show()</span>

<div class="viewcode-block" id="DiagPlot.save">
<a class="viewcode-back" href="../../api.html#splitpy.classes.DiagPlot.save">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves current figure into file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str</span>
<span class="sd">            File name for diagnostic figure</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Pascal Audet &amp; Andrew Schaeffer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>